---
import Button from "./Button.astro";
---

<div class="max-w-xl mx-auto bg-white p-6 rounded-lg shadow-md grid gap-4">
  <h1 class="text-2xl font-bold">Text Case Converter</h1>
  <textarea
    id="textInput"
    class="w-full h-40 p-3 border border-zinc-300 rounded-md"
    placeholder="Enter your text here"></textarea>

  <div class="flex gap-2 flex-wrap">
    <Button
      size="small"
      variant="secondary"
      text="Sentence Case"
      data-sentence-case
    />
    <Button
      size="small"
      variant="secondary"
      text="lower case"
      data-lower-case
    />
    <Button
      size="small"
      variant="secondary"
      text="UPPER CASE"
      data-upper-case
    />
    <Button
      size="small"
      variant="secondary"
      text="Capitalized Case"
      data-capitalized-case
    />
    <Button
      size="small"
      variant="secondary"
      text="aLtErNaTiNg cAsE"
      data-alternating-case
    />
    <Button
      size="small"
      variant="secondary"
      text="Title Case"
      data-title-case
    />
  </div>

  <div class="grid grid-cols-2 gap-2">
    <Button text="Copy to Clipboard" data-copy-to-clipboard />
    <Button text="Clear" data-clear-text />
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const textArea = document.querySelector(
      "#textInput"
    ) as HTMLTextAreaElement;

    const sentenceCaseBtn = document.querySelector("[data-sentence-case]");
    const lowerCaseBtn = document.querySelector("[data-lower-case]");
    const upperCaseBtn = document.querySelector("[data-upper-case]");
    const capitalizedCaseBtn = document.querySelector(
      "[data-capitalized-case]"
    );
    const alternatingCaseBtn = document.querySelector(
      "[data-alternating-case]"
    );
    const titleCaseBtn = document.querySelector("[data-title-case]");
    const copyToClipboardBtn = document.querySelector(
      "[data-copy-to-clipboard]"
    );
    const clearTextBtn = document.querySelector("[data-clear-text]");

    // Sentence Case
    sentenceCaseBtn?.addEventListener("click", () => {
      let text = textArea.value.toLowerCase();
      text = text.replace(/(^\s*\w|[.!?]\s*\w)/g, (match) =>
        match.toUpperCase()
      );
      textArea.value = text;
    });

    // Lower Case
    lowerCaseBtn?.addEventListener("click", () => {
      let text = textArea.value.toLowerCase();
      textArea.value = text;
    });

    // Upper Case
    upperCaseBtn?.addEventListener("click", () => {
      let text = textArea.value.toUpperCase();
      textArea.value = text;
    });

    // Capitalized Case
    capitalizedCaseBtn?.addEventListener("click", () => {
      let text = textArea.value
        .toLowerCase()
        .replace(/\b\w/g, (match) => match.toUpperCase());
      textArea.value = text;
    });

    // Alternating Case
    alternatingCaseBtn?.addEventListener("click", () => {
      let text = textArea.value
        .split("")
        .map((char, index) =>
          index % 2 === 0 ? char.toLowerCase() : char.toUpperCase()
        )
        .join("");
      textArea.value = text;
    });

    // Title Case
    titleCaseBtn?.addEventListener("click", () => {
      const smallWords = [
        "the",
        "to",
        "and",
        "a",
        "an",
        "in",
        "on",
        "at",
        "for",
        "by",
        "with",
        "of",
        "is",
      ];
      let text = textArea.value
        .toLowerCase()
        .replace(/\b\w+/g, function (word, index) {
          if (index === 0 || !smallWords.includes(word)) {
            return word.charAt(0).toUpperCase() + word.slice(1);
          } else {
            return word;
          }
        });
      textArea.value = text;
    });

    // Copy to Clipboard
    copyToClipboardBtn?.addEventListener(
      "click",
      function (this: HTMLButtonElement) {
        const originalText = this.textContent;
        this.textContent = "Copied!";

        textArea.select();
        document.execCommand("copy");

        setTimeout(() => {
          this.textContent = originalText;
        }, 400);
      }
    );

    // Clear Text
    clearTextBtn?.addEventListener("click", () => {
      textArea.value = "";
    });
  });
</script>
